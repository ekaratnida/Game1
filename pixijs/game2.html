<!doctype html>
<html>
  <head>
    <script src="https://pixijs.download/release/pixi.min.js"></script>
    <script src="Player.js"></script>
  </head>
  <body>
    <script>
      let app;
      let player;
      let keys = {}

      
      window.onload = function() {
        // Create the application helper and add its render target to the page
        app = new PIXI.Application({ width: 800, height: 400, background: '#1099bb' });
        document.body.appendChild(app.view);
        
        PIXI.Assets.add("player","images/sprites/player.png")
        PIXI.Assets.add("background","images/sprites/background.png");
        
        const texturePromise = PIXI.Assets.load(['player','background']);
        texturePromise.then(doneLoading);

        window.addEventListener("keydown", keysDown);
        window.addEventListener("keyup", keysUp);
       
      }

      function doneLoading(textures){
        createPlayer(textures);
        app.ticker.add(gameLoop);

      }

      function createPlayer(textures){
        player = new Player
        (
          app.view.width/2,
          app.view.height - 50,
          textures.player,
          "player",
          10,
          5,
          0.1,
          0.1
        );

        //console.log(player);
        app.stage.addChild(player)
      }

      function keysDown(e) {
          keys[e.keyCode] = true;
      }

      function keysUp(e) {
        keys[e.keyCode] = false;
      }

      function gameLoop(delta) {
        //console.info(JSON.stringify(keys));
        if (keys["65"]){
          player.moveLeft()
        }

        if (keys["68"]){
          player.x += 5;
        }
      }

    </script>
  </body>
</html>